$.fn.graphix=function(f){var n={width:600,height:500,onelementclick:function(i){},oncategoryclick:function(i){},mode:"table",input:"",type:"bar",background:"#101010"};var f=$.extend(n,f);var g;var D=$(this);D.wrap("<div />");var m=D.parent();var F=["0-#e77200-#862300:15-#e77200","0-#ff4884-#75002c:15-#e70067","0-#159c03-#030:15-#159c03","0-#037a9c-#004055:15-#037a9c","0-#ee0510-#a90000:15-#ee0510","0-#053cee-#2800a9:15-#053cee","0-#05eea4-#00a950:15-#05eea4","0-#e0ee05-#a3a900:15-#e0ee05","0-#ee05eb-#a700a9:15-#ee05eb","0-#f6607d-#d23756:15-#f6607d","0-#dd6e3c-#f94f00:15-#dd6e3c","0-#c6d600-#84871c:15-#c6d600","0-#7a62b5-#503a87:15-#7a62b5","0-#b9c39a-#91a77c:15-#b9c39a"];var v=["#e77200","#e70067","#159c03","#037a9c","#ee0510","#053cee","#05eea4","#e0ee05","#ee05eb","#f6607d","#dd6e3c","#c6d600","#7a62b5","#b9c39a"];var t,A,J,B,d,z=0,x=0;var I=new Array();var y=0,z=0,x=0;var C=new Array();var E=f.height-70;var H=(f.height-100)/10;var u=0,G=0,r;var q=new Array();if(f.mode=="table"){t=$.makeArray(D.find("thead th"));A=$.makeArray(D.find("tbody th"));for(z=0;z<t.length;z++){t[z]=t[z].innerHTML}for(z=0;z<A.length;z++){A[z]=A[z].innerHTML}J=D.find("caption").html();B=D.find("caption#legend").html();d=D.find("caption").width();r=t.length;if(r==0){r=1}for(z=0;z<A.length;z++){I[z]=new Array();for(x=0;x<r;x++){I[z][x]=D.find("tbody tr:eq("+z+") td:eq("+x+")").html();if(Math.ceil(parseInt(I[z][x]))>y){y=Math.ceil(I[z][x])}}}}else{if(f.mode=="xml"){t=new Array();A=new Array();J=$(f.input).attr("title");B=$(f.input).attr("legendy");d=80;r=t.length;if(r==0){r=1}$(f.input).find("object").each(function(){x=0;A[z]=$(this).attr("name");I[z]=new Array();$(this).find("category").each(function(){t[x]=$(this).attr("name");I[z][x]=$(this).attr("value");if(Math.ceil(parseInt(I[z][x]))>y){y=Math.ceil(I[z][x])}x++});z++})}else{if(f.mode=="json"){}else{if(f.mode=="array"){}}}}u=I[0].length*A.length;if(f.background=="none"){$(m).css({width:f.width,height:f.height})}else{$(m).css({width:f.width,height:f.height,background:f.background})}var c=Raphael($(this).parent()[0],f.width,f.height);$(D).remove();var o,s;function p(){s=c.path("M40 30L40 "+(f.height-70)).attr({stroke:"#717171"});o=c.path("M40 "+(f.height-70)+"L"+(f.width-30)+" "+(f.height-70)).attr({stroke:"#717171"});c.path("M"+(f.width-29)+" 30L "+(f.width-29)+" "+(f.height-70)).attr({stroke:"#666666"});c.text(f.width-19,f.height/2,B).attr({fill:"#717171"}).rotate(90);c.text(20,f.height-70,"0").attr({fill:"#717171"});$(m).prepend("<span style='position:absolute;color:#ffffff;padding-left:5px;'>"+J+"</span>");var j=30;var i=0;while(j<(f.height-70)){c.text(20,j,y-i+" ").attr({fill:"#888888"});y_line=c.path("M40 "+(j)+" L"+(f.width-30)+" "+(j)).attr({stroke:"#777777","stroke-dasharray":"-"});j=j+H;i=Math.floor(i+y/10);G++}}function a(){H=(f.width-70)/10;s=c.path("M30 30L30 "+(f.height-70)).attr({stroke:"#717171"});o=c.path("M30 "+(f.height-70)+"L"+(f.width-40)+" "+(f.height-70)).attr({stroke:"#717171"});c.text(30,f.height-60,"0").attr({fill:"#717171"});$(m).prepend("<span style='position:absolute;color:#ffffff;padding-left:5px;'>"+J+"</span>");c.path("M30 30L"+(f.width-40)+" 30 ").attr({stroke:"#717171"});c.text(f.width-140,20,B).attr({fill:"#717171","font-size":f.height/35});var j=H+30;var i=Math.floor(y/10);while(j<(f.width-10)){c.text(j,E+10,i+" ").attr({fill:"#888888"});y_line=c.path("M "+(j)+" 30 L"+(j)+" "+(E)).attr({stroke:"#777777","stroke-dasharray":"-"});j=j+H;i=Math.floor(i+y/10);G++}$(m).prepend("<span style='position:absolute;color:#ffffff;padding-left:5px;'>"+J+"</span>")}function k(){var L=Math.floor((f.width-70)/u-(A.length/1.5));var N=new Array();var K=40,i,j=0;C=new Array();for(z=0;z<A.length;z++){for(x=0;x<t.length;x++){i=Math.floor(I[z][x]/y*G*H);C[j]=c.rect(K,E-i,L,i).attr({fill:F[x],stroke:v[x]});$(C[j].node).attr("id",I[z][x]+" "+t[x]+" "+A[z]);N[j]=i;K=K+L+2;C[j].click(function(){f.onelementclick($(this.node).attr("id"))});j++}c.text(K-(L/2+(L/2)*(t.length-1)),E+10,A[z]).attr({fill:"#CCCCCC"});K=K+t.length}o.toFront();K=40;var M=0;for(z=0;z<t.length;z++){i=c.rect(K,E+35,20,20).attr({fill:F[z],stroke:v[z]});$(i.node).attr("id",t[z]);i.click(function(){f.oncategoryclick($(this.node).attr("id"))});i.mouseover(function(){g=c.text(this.attr("x"),this.attr("y")+27,$(this.node).attr("id")).attr({fill:"#ffffff"});var O=""+this.attr("stroke");for(x=0;x<C.length;x++){if(C[x].attr("stroke")!=O){C[x].animate({height:0,y:E},1300,"bounce")}}});i.mouseout(function(){g.remove();var O=""+this.attr("stroke");for(x=0;x<C.length;x++){if(C[x].attr("stroke")!=O){C[x].animate({height:N[x],y:E-N[x]},1300,"bounce")}}});K=K+f.width/(t.length+1)}c.text(90,E+25,"Categories: Hover to filter/show labels").attr({fill:"#ffffff"})}function w(){var M=Math.floor((f.height-110)/u-(t.length/1.5));var O=0;var L=40,i,N=new Array(),P,K,j=0;for(z=0;z<A.length;z++){P=30;K=0;for(x=0;x<t.length;x++){i=Math.floor(I[z][x]/y*G*H);if(i>K){O=i-K}else{O=K-i;P=P+i-K}N[j]=c.rect(P,L,O,M).attr({fill:F[x],stroke:v[x]});$(N[j].node).attr("id",I[z][x]+" "+t[x]+" "+A[z]);N[j++].click(function(){f.onelementclick($(this.node).attr("id"))});if(i>K){P=P+i-K}K=i;L=L+M+2}c.text(20,L-M*2,A[z]).attr({fill:"#717171"}).rotate(-90);L=L+t.length}s.toFront();L=40;for(z=0;z<t.length;z++){i=c.rect(L,E+35,20,20).attr({fill:F[z],stroke:v[z]});$(i.node).attr("id",t[z]);i.click(function(){f.oncategoryclick($(this.node).attr("id"))});i.mouseover(function(){g=c.text(this.attr("x"),this.attr("y")+27,$(this.node).attr("id")).attr({fill:"#ffffff"});var Q=""+this.attr("stroke");for(x=0;x<N.length;x++){if(N[x].attr("stroke")!=Q){N[x].animate({opacity:0,"stroke-opacity":0},1300,">")}}});i.mouseout(function(){g.remove();var Q=""+this.attr("stroke");for(x=0;x<N.length;x++){if(N[x].attr("stroke")!=Q){N[x].animate({opacity:1,"stroke-opacity":1},1300,"bounce")}}});L=L+f.width/(t.length+1)}c.text(90,E+25,"Categories: Hover to filter/show labels").attr({fill:"#ffffff"})}function l(){var M,L,K;var j,i;var N=new Array();q=new Array();for(z=0;z<t.length;z++){M=(f.width-10)/A.length;L=Math.floor(I[0][z]/y*G*H);K="M40 "+E+" L"+M+" "+(E-L)+" ";q[z]=c.set();j=M;i=L;for(x=0;x<A.length;x++){L=Math.floor(I[x][z]/y*G*H);q[z].push(c.circle(M,(E-L),2).attr({stroke:v[z],fill:v[z],"stroke-width":2}));K=K+j+" "+(E-i)+" L "+M+" "+(E-L)+" ";j=M;i=L;M=M+(f.width-31)/A.length}N[z]=c.path(K).attr({stroke:v[z],"stroke-width":2});$(N[z].node).attr("id",t[z]);N[z].click(function(){f.onelementclick($(this.node).attr("id"))})}M=(f.width-40)/A.length;for(z=0;z<A.length;z++){c.text(M,E+10,A[z]).attr({fill:"#ffffff"});M=M+(f.width-40)/A.length}o.toFront();M=40;var O=0;for(z=0;z<t.length;z++){L=c.rect(M,E+35,20,20).attr({fill:v[z],stroke:v[z]});$(L.node).attr("id",t[z]);L.click(function(){f.oncategoryclick($(this.node).attr("id"))});L.mouseover(function(){var P=""+this.attr("stroke");g=c.text(this.attr("x"),this.attr("y")+27,$(this.node).attr("id")).attr({fill:"#ffffff"});for(x=0;x<N.length;x++){if(N[x].attr("stroke")!=P){q[x].attr({opacity:0});N[x].animate({opacity:0},1300,">")}}});L.mouseout(function(){g.remove();var P=""+this.attr("stroke");for(x=0;x<N.length;x++){if(N[x].attr("stroke")!=P){N[x].animate({opacity:1},1300,"bounce");q[x].attr({opacity:1})}}});M=M+f.width/(t.length+1)}c.text(90,E+25,"Categories: Hover to filter/show labels").attr({fill:"#ffffff"})}function b(){var O=f.width/2,L=f.height/2,i=f.width/3;$(m).prepend("<span style='position:absolute;color:#ffffff;padding-left:5px;font-size:10px'>"+J+"</span>");var S=Math.PI/180;function N(ac,ab,X,ae,aa,ad){var Z=ac+X*Math.cos(-ae*S),Y=ac+X*Math.cos(-aa*S),ag=ab+X*Math.sin(-ae*S),af=ab+X*Math.sin(-aa*S);return c.path(["M",ac,ab,"L",Z,ag,"A",X,X,0,+(aa-ae>180),0,Y,af,"z"]).attr({fill:90+""+F[ad],stroke:v[ad]})}var W=0;var M,V,U;var K,j;var R,T=0,Q=new Array();for(z=0;z<A.length;z++){T=T+parseInt(I[z][0])}for(z=0;z<A.length;z++){M=parseInt(I[z][0])/T*360;R=W+M;V=O+(i+45)*Math.cos(-(W+M/2)*S);U=L+(i+25)*Math.sin(-(W+M/2)*S);K=O+(i-i/4)*Math.cos(-(W+M/2)*S);j=L+(i-i/4)*Math.sin(-(W+M/2)*S);c.text(V,U,A[z]).attr({fill:"#ffffff"}).toFront();Q[z]=N(O,L,i,W,R,z);$(Q[z].node).attr("id",I[z][0]+" "+A[z]);Q[z].click(function(){f.onelementclick($(this.node).attr("id"))});Q[z].mouseover(function(){var X=""+this.attr("stroke");for(x=0;x<Q.length;x++){if(Q[x].attr("stroke")!=X){Q[x].animate({opacity:0,"stroke-opacity":0},1300,">")}}});Q[z].mouseout(function(){var X=""+this.attr("stroke");for(x=0;x<Q.length;x++){if(Q[x].attr("stroke")!=X){Q[x].animate({opacity:1,"stroke-opacity":1},1300,"bounce")}}});var P=I[z][0]/T*100+"";P=P.substr(0,7)+"%";c.text(K,j,P).attr({fill:"#ffffff","font-size":i/12});W=R}}function e(){var M,P,O,i=new Array(),Q=new Array();var L,K;q=new Array();for(z=0;z<t.length;z++){M=(f.width-10)/A.length;P=Math.floor(I[0][z]/y*G*H);var N="M40 "+E+" L"+M+" "+(E-P)+" ";L=M;K=P;q[z]=c.set();for(x=0;x<A.length;x++){P=Math.floor(I[x][z]/y*G*H);q[z].push(c.circle(M,(E-P),2).attr({stroke:v[z],"stroke-width":2,fill:v[z]}));N=N+L+" "+(E-K)+" L "+M+" "+(E-P)+" ";L=M;K=P;M=M+(f.width-35)/A.length}i[z]=c.path(N+L+" "+(E-K)+" L "+L+" "+(E)+" L 40 "+E+"z").attr({fill:v[z],stroke:v[z],"stroke-width":1,opacity:0.5,"stroke-opacity":1});$(i[z].node).attr("id",t[z]);i[z].click(function(){f.onelementclick($(this.node).attr("id"))})}M=(f.width-40)/A.length;for(z=0;z<A.length;z++){c.text(M,E+10,A[z]).attr({fill:"#ffffff"});M=M+(f.width-40)/A.length}o.toFront();M=40;var j=0;for(z=0;z<t.length;z++){P=c.rect(M,E+35,20,20).attr({fill:v[z],stroke:v[z]});$(P.node).attr("id",t[z]);P.click(function(){f.oncategoryclick($(this.node).attr("id"))});P.mouseover(function(){var R=""+this.attr("stroke");g=c.text(this.attr("x"),this.attr("y")+27,$(this.node).attr("id")).attr({fill:"#ffffff"});for(x=0;x<i.length;x++){if(i[x].attr("stroke")!=R){i[x].animate({opacity:0,"stroke-width":0},1300,">");q[x].attr({opacity:0})}else{i[x].animate({opacity:1},1300,">")}}});P.mouseout(function(){var R=""+this.attr("stroke");g.remove();for(x=0;x<i.length;x++){q[x].attr({opacity:1});i[x].animate({opacity:0.5,"stroke-width":0},1300,">")}});M=M+f.width/(t.length+1)}c.text(90,E+25,"Categories: Hover to filter/show labels").attr({fill:"#ffffff"})}function h(){var M,K,N,O=new Array(),L=0;var j,i;for(z=0;z<t.length;z++){M=(f.width-40)/A.length;K=Math.floor(I[0][z]/y*G*H);j=M;i=K;for(x=0;x<A.length;x++){K=Math.floor(I[x][z]/y*G*H);O[L]=c.circle(M,(E-K),I[x][z]).attr({fill:v[z],stroke:v[z],"stroke-width":1,opacity:0.5});$(O[L].node).attr("id",I[x][z]+" "+t[z]+" "+A[x]);O[L++].click(function(){f.onelementclick($(this.node).attr("id"))});j=M;i=K;M=M+(f.width-40)/A.length}}M=(f.width-40)/A.length;for(z=0;z<A.length;z++){c.text(M,E+10,A[z]).attr({fill:"#ffffff"});M=M+(f.width-40)/A.length}o.toFront();M=40;var P=0;for(z=0;z<t.length;z++){K=c.rect(M,E+35,20,20).attr({fill:v[z],stroke:v[z]});$(K.node).attr("id",t[z]);K.click(function(){f.oncategoryclick($(this.node).attr("id"))});K.mouseover(function(){var Q=""+this.attr("stroke");g=c.text(this.attr("x"),this.attr("y")+27,$(this.node).attr("id")).attr({fill:"#ffffff"});for(x=0;x<O.length;x++){if(O[x].attr("stroke")!=Q){O[x].animate({opacity:0,"stroke-width":0},1300,">")}else{O[x].animate({opacity:1},1300,">")}}});K.mouseout(function(){var Q=""+this.attr("stroke");g.remove();for(x=0;x<O.length;x++){O[x].animate({opacity:0.5,"stroke-width":0},1300,"bounce")}});M=M+f.width/(t.length+1)}c.text(90,E+25,"Categories: Hover to filter/show labels").attr({fill:"#ffffff"})}switch(f.type){case"bar":p();k();break;case"line":p();l();break;case"area":p();e();break;case"bubble":p();h();break;case"gantt":a();w();break;case"pie":b();break;default:p();k();break}};